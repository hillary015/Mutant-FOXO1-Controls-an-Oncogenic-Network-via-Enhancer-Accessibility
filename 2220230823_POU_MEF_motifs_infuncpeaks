cd /Volumes/Hillary_X6/Nud_DHL4_ATAC_forTobias/TF_footprinting_out/Functional_peaks/

cat DHL40hvLY10h/MA0507.1.POU2F2_MA0507.1/beds/MA0507.1.POU2F2_MA0507.1_DHL4_bound.bed DHL40hvNUD0h/MA0507.1.POU2F2_MA0507.1/beds/MA0507.1.POU2F2_MA0507.1_DHL4_bound.bed DHL40hvLY10h/MA0507.2.POU2F2_MA0507.2/beds/MA0507.2.POU2F2_MA0507.2_DHL4_bound.bed DHL40hvNUD0h/MA0507.2.POU2F2_MA0507.2/beds/MA0507.2.POU2F2_MA0507.2_DHL4_bound.bed DHL40hvLY10h/MA0628.1.POU6F1_MA0628.1/beds/MA0628.1.POU6F1_MA0628.1_DHL4_bound.bed DHL40hvNUD0h/MA0628.1.POU6F1_MA0628.1/beds/MA0628.1.POU6F1_MA0628.1_DHL4_bound.bed DHL40hvLY10h/MA0785.1.POU2F1_MA0785.1/beds/MA0785.1.POU2F1_MA0785.1_DHL4_bound.bed DHL40hvNUD0h/MA0785.1.POU2F1_MA0785.1/beds/MA0785.1.POU2F1_MA0785.1_DHL4_bound.bed  DHL40hvLY10h/MA1115.1.POU5F1_MA1115.1/beds/MA1115.1.POU5F1_MA1115.1_DHL4_bound.bed DHL40hvNUD0h/MA1115.1.POU5F1_MA1115.1/beds/MA1115.1.POU5F1_MA1115.1_DHL4_bound.bed DHL40hvLY10h/MA1549.1.POU6F1_MA1549.1/beds/MA1549.1.POU6F1_MA1549.1_DHL4_bound.bed DHL40hvNUD0h/MA1549.1.POU6F1_MA1549.1/beds/MA1549.1.POU6F1_MA1549.1_DHL4_bound.bed > 20230823_POU_DHL4_bound_motifs_cat.bed

sort -k1,1 -k2,2n 20230823_POU_DHL4_bound_motifs_cat.bed > 20230823_POU_DHL4_bound_motifs_cat_sorted.bed
bedtools merge -i 20230823_POU_DHL4_bound_motifs_cat_sorted.bed > 20230823_POU_DHL4_bound_motifs_cat_sorted_merged.bed

bedtools intersect -a ../20230823_intersect_functionalpeaksmutonly_withDHL4conpeaks_uoverlap.txt -b 20230823_POU_DHL4_bound_motifs_cat_sorted_merged.bed -wa -wb > 20230823_intersect_functionalpeaksmutonly_DHL4conpeaks_withPOUboudmoitfs_wa_wb.txt

bedtools intersect -a ../20230823_intersect_functionalpeaksmutonly_withDHL4conpeaks_uoverlap.txt -b 20230823_POU_DHL4_bound_motifs_cat_sorted_merged.bed -wa -wb > 20230823_intersect_functionalpeaksmutonly_DHL4conpeaks_withPOUboudmoitfs_wa_wb.txt
bedtools intersect -a ../20230823_intersect_functionalpeaksmutonly_withDHL4conpeaks_uoverlap.txt -b 20230823_POU_DHL4_bound_motifs_cat_sorted_merged.bed -u > 20230823_intersect_functionalpeaksmutonly_DHL4conpeaks_withPOUboudmoitfs_ufuncpeakonly.txt
bedtools intersect -a ../20230823_intersect_functionalpeaksmutonly_withDHL4conpeaks_uoverlap.txt -b 20230823_POU_DHL4_bound_motifs_cat_sorted_merged.bed -wb > 20230823_intersect_functionalpeaksmutonly_DHL4conpeaks_withPOUboudmoitfs_wbmotifonly.txt

cat DHL40hvLY10h/MA0052.1.MEF2A_MA0052.1/beds/MA0052.1.MEF2A_MA0052.1_DHL4_bound.bed DHL40hvNUD0h/MA0052.1.MEF2A_MA0052.1/beds/MA0052.1.MEF2A_MA0052.1_DHL4_bound.bed DHL40hvLY10h/MA0052.2.MEF2A_MA0052.2/beds/MA0052.2.MEF2A_MA0052.2_DHL4_bound.bed DHL40hvNUD0h/MA0052.2.MEF2A_MA0052.2/beds/MA0052.2.MEF2A_MA0052.2_DHL4_bound.bed DHL40hvLY10h/MA0052.3.MEF2A_MA0052.3/beds/MA0052.3.MEF2A_MA0052.3_DHL4_bound.bed DHL40hvNUD0h/MA0052.3.MEF2A_MA0052.3/beds/MA0052.3.MEF2A_MA0052.3_DHL4_bound.bed DHL40hvLY10h/MA0052.4.MEF2A_MA0052.4/beds/MA0052.4.MEF2A_MA0052.4_DHL4_bound.bed DHL40hvNUD0h/MA0052.4.MEF2A_MA0052.4/beds/MA0052.4.MEF2A_MA0052.4_DHL4_bound.bed DHL40hvLY10h/MA0497.1.MEF2C_MA0497.1/beds/MA0497.1.MEF2C_MA0497.1_DHL4_bound.bed DHL40hvNUD0h/MA0497.1.MEF2C_MA0497.1/beds/MA0497.1.MEF2C_MA0497.1_DHL4_bound.bed DHL40hvLY10h/MA0660.1.MEF2B_MA0660.1/beds/MA0660.1.MEF2B_MA0660.1_DHL4_bound.bed DHL40hvNUD0h/MA0660.1.MEF2B_MA0660.1/beds/MA0660.1.MEF2B_MA0660.1_DHL4_bound.bed DHL40hvLY10h/MA0773.1.MEF2D_MA0773.1/beds/MA0773.1.MEF2D_MA0773.1_DHL4_bound.bed DHL40hvNUD0h/MA0773.1.MEF2D_MA0773.1/beds/MA0773.1.MEF2D_MA0773.1_DHL4_bound.bed > 20230823_MEF_DHL4_bound_motifs_cat.bed

sort -k1,1 -k2,2n 20230823_MEF_DHL4_bound_motifs_cat.bed > 20230823_MEF_DHL4_bound_motifs_cat_sorted.bed
bedtools merge -i 20230823_MEF_DHL4_bound_motifs_cat_sorted.bed > 20230823_MEF_DHL4_bound_motifs_cat_sorted_merged.bed

mergePeaks -d given ../20230823_intersect_functionalpeaksmutonly_withDHL4conpeaks_uoverlap.txt 20230823_POU_DHL4_bound_motifs_cat_sorted_merged.bed 20230823_MEF_DHL4_bound_motifs_cat_sorted_merged.bed > 20230823_mergePeaks_funcmutonlywithDHL4conpeak_POU2DHL4bound_MEF2DHL4bound.txt -venn 20230823_mergePeaks_funcmutonlywithDHL4conpeak_POU2DHL4bound_MEF2DHL4bound_venn.txt
